#!/usr/bin/env bash
# pluginlist — install vim plugins via pathogen
# Usage:  cd ~/.config/vim && bash pluginlist
#
# Each plugin is cloned into plugins/<name>.vim
# Pathogen only loads directories ending in .vim
# To disable a plugin: rename to remove the .vim suffix

PLUGIN_DIR="${XDG_CONFIG_HOME:-$HOME/.config}/vim/plugins"
mkdir -p "$PLUGIN_DIR"

clone() {
    local repo="$1"
    local name="$2"
    local target="$PLUGIN_DIR/$name.vim"
    if [ -d "$target" ]; then
        echo "  skip  $name (already installed)"
    else
        echo "  clone $name"
        git clone --depth 1 "$repo" "$target"
    fi
}

echo "Installing vim plugins into $PLUGIN_DIR"
echo ""

# File navigation
clone https://github.com/preservim/nerdtree               NERDTree
clone https://github.com/kien/ctrlp.vim                   ctrlp

# UI
clone https://github.com/vim-airline/vim-airline          airline
clone https://github.com/junegunn/goyo.vim                goyo
clone https://github.com/preservim/tagbar                 tagbar
clone https://github.com/jonhiggs/vim-readline            readline 

# Editing
clone https://github.com/tpope/vim-commentary             commentary
clone https://github.com/tpope/vim-surround               surround
clone https://github.com/godlygeek/tabular                tabular
clone https://github.com/maxbrunsfeld/vim-yankstack       yankstack

# Buffers & scrolling
clone https://github.com/jlanzarotta/bufexplorer          bufExplorer
clone https://github.com/yuttie/comfortable-motion.vim    comfortable-motion

# Git / utilities
clone https://github.com/vim-scripts/netrw.vim            netrw

# Completion (YouCompleteMe — requires compilation after clone)
YCM_DIR="$PLUGIN_DIR/YouCompleteMe.vim"
if [ -d "$YCM_DIR" ]; then
    echo "  skip  YouCompleteMe (already installed)"
else
    echo "  clone YouCompleteMe (this takes a minute...)"
    git clone --recurse-submodules https://github.com/ycm-core/YouCompleteMe.git "$YCM_DIR"
    if [ $? -eq 0 ]; then
        echo "  build YouCompleteMe..."
        cd "$YCM_DIR"
        # --clangd-completer: C/C++ via clangd (lighter than libclang)
        # --ts-completer:     JavaScript/TypeScript
        # Add --java-completer, --go-completer, --rust-completer as needed
        python3 install.py --clangd-completer --ts-completer
        cd - > /dev/null
    fi
fi

echo ""
echo "Done. Restart vim to load new plugins."
echo ""
echo "To rebuild YCM (e.g. after adding language support):"
echo "  cd $YCM_DIR && python3 install.py --clangd-completer --ts-completer"
